<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: screens/GraphPage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: screens/GraphPage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Code for the user's Graph screen.
 * Displays line and pie charts for weekly, monthly and yearly expense data,
 * organized by category as well
 */

import { AntDesign } from '@expo/vector-icons';
import * as React from 'react';
import { useState, useEffect } from 'react';
import { StyleSheet, Text, View, TouchableOpacity } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';
import Swiper from 'react-native-swiper';

import LineGraphComponent from '../components/LineGraphComponent';
import PieChartComponent from '../components/PieChartComponent';
import WeekMonthYearButtons from '../components/WeekMonthYearComponent';
import * as Colors from '../constants/Colors';
import { YEARLY, MONTHLY, WEEKLY } from '../constants/FrequencyConstants';
import {
    getCurrentDateString,
    getWeekStartEndDate,
    getNextWeekStartEndDate,
    getPreviousWeekStartEndDate,
    getMonthStartEndDate,
    getNextMonthStartEndDate,
    getPreviousMonthStartEndDate,
    getYearStartEndDate,
    getPreviousYearStartEndDate,
    getNextYearStartEndDate,
} from '../util/DatetimeUtils';

const GraphPage = ({ navigation }) => {
    const [selectedTimeframe, setSelectedTimeframe] = useState(WEEKLY);
    const [selectedTimeframeDates, setSelectedTimeframeDates] = useState(
        getWeekStartEndDate(getCurrentDateString())
    );

    const handleTimeframeSelect = (value) => {
        setSelectedTimeframe(value);

        if (value === WEEKLY) {
            const selectedTimeframeDates = getWeekStartEndDate(getCurrentDateString());
            setSelectedTimeframeDates(selectedTimeframeDates);
        } else if (value === MONTHLY) {
            const selectedTimeframeDates = getMonthStartEndDate(getCurrentDateString());
            setSelectedTimeframeDates(selectedTimeframeDates);
        } else if (value === YEARLY) {
            const selectedTimeframeDates = getYearStartEndDate(getCurrentDateString());
            setSelectedTimeframeDates(selectedTimeframeDates);
        }
    };

    const handleIncrementTimeFrame = () => {
        if (selectedTimeframe === WEEKLY) {
            if (new Date(getCurrentDateString()) > new Date(selectedTimeframeDates[1])) {
                setSelectedTimeframeDates(getNextWeekStartEndDate(selectedTimeframeDates[1]));
            }
        } else if (selectedTimeframe === MONTHLY) {
            if (new Date(getCurrentDateString()) > new Date(selectedTimeframeDates[1])) {
                setSelectedTimeframeDates(getNextMonthStartEndDate(selectedTimeframeDates[1]));
            }
        } else if (selectedTimeframe === YEARLY) {
            if (new Date(getCurrentDateString()) > new Date(selectedTimeframeDates[1])) {
                setSelectedTimeframeDates(getNextYearStartEndDate(selectedTimeframeDates[1]));
            }
        }
    };

    const handleDecrementTimeFrame = () => {
        if (selectedTimeframe === WEEKLY) {
            setSelectedTimeframeDates(getPreviousWeekStartEndDate(selectedTimeframeDates[1]));
        } else if (selectedTimeframe === MONTHLY) {
            setSelectedTimeframeDates(getPreviousMonthStartEndDate(selectedTimeframeDates[1]));
        } else if (selectedTimeframe === YEARLY) {
            setSelectedTimeframeDates(getPreviousYearStartEndDate(selectedTimeframeDates[1]));
        }
    };

    const formatDateforDisplay = (dateString) => {
        const date = new Date(dateString + 'T00:00:00Z'); // Set the time zone to UTC
        const year = date.getUTCFullYear();
        const month = String(date.getUTCMonth() + 1).padStart(2, '0');
        const day = String(date.getUTCDate()).padStart(2, '0');
        return `${month}/${day}/${year}`;
    };

    const [activeSlide, setActiveSlide] = useState(0);

    useEffect(() => {
        const unsubscribe = navigation.addListener('state', () => {
            // When the page comes into focus, set the active slide to 0 (the first slide)
            setActiveSlide(0);
            setSelectedTimeframe(WEEKLY);
            setSelectedTimeframeDates(getWeekStartEndDate(getCurrentDateString()));
        });
        return unsubscribe;
    }, []);

    return (
        &lt;SafeAreaView style={styles.container}>
            &lt;View style={styles.titleContainer}>
                &lt;Text style={styles.titleText}>Statistics&lt;/Text>
            &lt;/View>
            &lt;View style={{ backgroundColor: Colors.PRIMARYCOLOR }}>
                &lt;View style={styles.dateContainer}>
                    &lt;View style={styles.dateRange}>
                        &lt;TouchableOpacity onPress={handleDecrementTimeFrame}>
                            &lt;View style={styles.arrow}>
                                &lt;AntDesign
                                    name="leftcircle"
                                    color={Colors.SECONDARYCOLOR}
                                    backgroundColor={Colors.PRIMARYCOLOR}
                                    size={30}
                                />
                            &lt;/View>
                        &lt;/TouchableOpacity>
                        &lt;Text style={styles.date}>
                            {`${formatDateforDisplay(selectedTimeframeDates[0])}`}
                        &lt;/Text>
                        &lt;Text> _ &lt;/Text>
                        &lt;Text style={styles.date}>
                            {`${formatDateforDisplay(selectedTimeframeDates[1])}`}
                        &lt;/Text>
                        &lt;TouchableOpacity onPress={handleIncrementTimeFrame}>
                            &lt;View style={styles.arrow}>
                                &lt;AntDesign
                                    name="rightcircle"
                                    color={Colors.SECONDARYCOLOR}
                                    backgroundColor={Colors.PRIMARYCOLOR}
                                    size={30}
                                />
                            &lt;/View>
                        &lt;/TouchableOpacity>
                    &lt;/View>
                &lt;/View>
                &lt;WeekMonthYearButtons onSelect={handleTimeframeSelect} />
                &lt;View style={styles.scrollableContent}>
                    &lt;Swiper
                        style={styles.wrapper}
                        dotStyle={styles.customDot}
                        activeDotStyle={styles.customActiveDot}
                        paginationStyle={{
                            top: -560,
                            left: 300,
                        }}
                        loop={false}
                        index={activeSlide}
                        onIndexChanged={(index) => {
                            setActiveSlide(index);
                        }}>
                        &lt;View style={styles.pieChartSlide}>
                            &lt;View style={styles.chartContainer}>
                                &lt;PieChartComponent
                                    startDate={selectedTimeframeDates[0]}
                                    endDate={selectedTimeframeDates[1]}
                                    timeFrame={selectedTimeframe}
                                />
                            &lt;/View>
                        &lt;/View>
                        &lt;View style={styles.lineChartSlide}>
                            &lt;View style={styles.chartContainer} paddingTop={20}>
                                &lt;LineGraphComponent
                                    startDate={selectedTimeframeDates[0]}
                                    endDate={selectedTimeframeDates[1]}
                                    timeFrame={selectedTimeframe}
                                />
                            &lt;/View>
                        &lt;/View>
                    &lt;/Swiper>
                &lt;/View>
            &lt;/View>
        &lt;/SafeAreaView>
    );
};

export default GraphPage;

const styles = StyleSheet.create({
    // Need to figure out why there is a big gab at the top of the screen
    container: {
        //paddingTop: StatusBar.currentHeight,
        flex: 1,
        alignItems: 'center',
        backgroundColor: Colors.SECONDARYCOLOR,
    },
    scrollableContent: {
        flex: 1,
        width: '100%', // Adjust the width as needed
        height: 'auto',
        alignItems: 'center',
        marginTop: -20,
    },
    titleContainer: {
        width: 'auto',
    },
    titleText: {
        fontWeight: 'bold',
        fontSize: 35,
        color: Colors.PRIMARYCOLOR,
        justifyContent: 'center',
    },
    dateContainer: {
        //flex: 1,
        alignItems: 'center',
    },
    arrow: {
        alignSelf: 'center',
        alignItem: 'center',
        margin: 5,
        paddingTop: 15,
    },
    dateRange: {
        flexDirection: 'row',
        alignItems: 'center',
        width: 310,
    },
    date: {
        textAlign: 'center',
        paddingVertical: 10,
        fontSize: 14,
        flex: 1,
        borderWidth: 1,
        borderColor: Colors.SECONDARYCOLOR,
        backgroundColor: Colors.PRIMARYCOLOR,
        borderRadius: 15,
        marginTop: 20,
        marginHorizontal: 2,
        overflow: 'hidden',
    },
    wrapper: {
        //showsPagination: true,
    },
    lineChartSlide: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        paddingBottom: 100,
    },
    pieChartSlide: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        paddingBottom: 100,
    },
    customDot: {
        width: 10,
        height: 10,
        borderRadius: 5,
        backgroundColor: 'gray', // Color for non-active dots
    },
    customActiveDot: {
        width: 10,
        height: 10,
        borderRadius: 5,
        backgroundColor: Colors.SECONDARYCOLOR, // Color for the active dot
    },
    scrollContentContainer: {
        paddingBottom: 60,
    },
    chartContainer: {
        margin: 5,
        height: '100%',
        width: '92%',
        alignContent: 'center',
        justifyContent: 'center',
        backgroundColor: 'white',
        borderRadius: 20,
    },
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-DatabaseUtils.html">DatabaseUtils</a></li><li><a href="module-DatetimeUtils.html">DatetimeUtils</a></li><li><a href="module-ExpenseTableUtils.html">ExpenseTableUtils</a></li><li><a href="module-ImageUtils.html">ImageUtils</a></li><li><a href="module-NameUtils.html">NameUtils</a></li><li><a href="module-RecurringTableUtils.html">RecurringTableUtils</a></li><li><a href="module-SQLiteUtils.html">SQLiteUtils</a></li></ul><h3>Namespaces</h3><ul><li><a href="Components.html">Components</a></li></ul><h3>Global</h3><ul><li><a href="global.html#TodaySpendingComponent">TodaySpendingComponent</a></li><li><a href="global.html#createExampleData">createExampleData</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Dec 12 2023 00:45:33 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
